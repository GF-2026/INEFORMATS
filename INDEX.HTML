<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formulario con Firma Precisa</title>
  <style>
    @page { size: A4; margin: 0; }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #ccc;
    }
    .page {
      position: relative;
      width: 210mm;
      height: 297mm;
      margin: 0 auto;
      background: white;
      page-break-after: always;
      background-size: cover;
    }
    .page1 { background-image: url("page1.jpg"); }
    .page2 { background-image: url("page2.jpg"); }

    form { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    .mnvm-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 190px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
    .mnvm-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 210px; /* Ajusta según el fondo */
      left: 257px; /* Ajusta según el fondo */
    }
    .mvm-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 237px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
    .mvm-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 263px; /* Ajusta según el fondo */
      left: 257px; /* Ajusta según el fondo */
    }
          .names-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 297px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
              .names-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 356px; /* Ajusta según el fondo */
      left: 238px; /* Ajusta según el fondo */
    }
      .lastname1-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 344px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
          .lastname1-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 409px; /* Ajusta según el fondo */
      left: 238px; /* Ajusta según el fondo */
    }
              .lastname2-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 392px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
          .lastname2-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 461px; /* Ajusta según el fondo */
      left: 239px; /* Ajusta según el fondo */
    }
          .year-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 438px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
              .year-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 514px; /* Ajusta según el fondo */
      left: 239.5px; /* Ajusta según el fondo */
    }
      .month-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 438px; /* Ajusta según el fondo */
      left: 308.5px; /* Ajusta según el fondo */
    }
    .month-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 514px; /* Ajusta según el fondo */
      left: 329.5px; /* Ajusta según el fondo */
    }
      .day-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 438px; /* Ajusta según el fondo */
      left: 357px; /* Ajusta según el fondo */
    }
    .day-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 514px; /* Ajusta según el fondo */
      left: 382.3px; /* Ajusta según el fondo */
    }

    /* CURP (una letra por celda) */
    .tel-container {
      display: flex;
      gap: 1.8px;
      position: absolute;
      top: 485px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
        .cel-container {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 485px; /* Ajusta según el fondo */
      left: 404px; /* Ajusta según el fondo */
    }
    .clave-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 532px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }
        .clave-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 566px; /* Ajusta según el fondo */
      left: 239px; /* Ajusta según el fondo */
    }

     .mail-container {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 580px; /* Ajusta según el fondo */
      left: 229.5px; /* Ajusta según el fondo */
    }

      .date-container1 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 820px; /* Ajusta según el fondo */
      left: 130px; /* Ajusta según el fondo */
    }
    .date-container2 {
      display: flex;
      gap: 1.5px;
      position: absolute;
      top: 736px; /* Ajusta según el fondo */
      left: 137px; /* Ajusta según el fondo */
    }
    .tel-container input {
      width: 9px;
      height: 20px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
    }
    .cel-container input {
      width: 9px;
      height: 20px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
    .clave-container1 input {
      width: 9px;
      height: 20px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
    .clave-container2 input {
      width: 10.5px;
      height: 20px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .mnvm-container1 input {
      width: 420px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
              .mnvm-container2 input {
      width: 396px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
        .mvm-container1 input {
      width: 420px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
                .mvm-container2 input {
      width: 396px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .names-container1 input {
      width: 420px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
              .names-container2 input {
      width: 416px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .lastname1-container1 input {
      width: 420px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
              .lastname1-container2 input {
      width: 416px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .lastname2-container1 input {
      width: 420px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
              .lastname2-container2 input {
      width: 416px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .mail-container input {
      width: 420px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
        .year-container1 input {
      width: 9.5px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
        .year-container2 input {
      width: 10.6px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .month-container1 input {
      width: 9.5px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
    .month-container2 input {
      width: 9.5px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
    .day-container1 input {
      width: 10px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
    .day-container2 input {
      width: 10px;
      height: 19px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
      .date-container input {
      width: 100px;
      height: 15px;
      text-align: center;
      font-size: 14px;
      border: 1px solid #888;
        }
 
    .signature-box1, .signature-box2 {
      position: absolute;
      border: 2px dashed #444;
      width: 250px;
      height: 100px;
      background: rgba(255,255,255,0.3);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }
    .signature-box1 { bottom: 255px; left: 410px; }
    .signature-box2 { bottom: 340px; left: 425px; }

    .signature-box1 img, .signature-box2 img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    #signatureModal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }

    #signatureModal .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      width: 90%;
      max-width: 400px;
    }

    #signaturePad {
      border: 2px solid #000;
      width: 100%;
      height: 200px;
      cursor: crosshair;
      touch-action: none;
    }

    .modal-content button {
      margin: 10px;
      padding: 8px 14px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    #clearBtn { background: #e74c3c; color: white; }
    #saveBtn { background: #2ecc71; color: white; }
    #closeBtn { background: #7f8c8d; color: white; }

    @media print {
      #signatureModal { display: none !important; }
    }
  </style>
</head>
<body>
  <div class="page page1">
    <form>
      <div class="tel-container">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>
            <div class="cel-container">
        <!-- 10 celdas CEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>
        <div class="clave-container1">
        <!-- 18 celdas CLAVE -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

      <div class="year-container1">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

          <div class="month-container1">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

        <div class="day-container1">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

        <div class="mnvm-container1">
        <!-- 40 celdas CLAVE -->
        <input maxlength="80" type="text">
      </div>
        <div class="mvm-container1">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
        <div class="names-container1">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
              <div class="lastname1-container1">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
        <div class="lastname2-container1">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
        <div class="mail-container">
        <!-- 40 celdas CLAVE -->
        <input maxlength="80" type="mail">
      </div>
            <div class="date-container1">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="date">
      </div>

    <div class="signature-box1">
        <canvas id="signature1"></canvas>
      </div>        
      <div class="signature-box1" onclick="abrirModal()">
        <img id="firma1" alt="Firma 1">
      </div>
    </form>
  </div>

  <div class="page page2">
    <form>
        <div class="clave-container2">
        <!-- 18 celdas CLAVE -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

      <div class="year-container2">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

          <div class="month-container2">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

        <div class="day-container2">
        <!-- 10 celdas TEL -->
        <input maxlength="1" type="text">
        <input maxlength="1" type="text">
      </div>

        <div class="mnvm-container2">
        <!-- 40 celdas CLAVE -->
        <input maxlength="80" type="text">
      </div>
        <div class="mvm-container2">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
        <div class="names-container2">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
        <div class="lastname1-container2">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
        <div class="lastname2-container2">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="text">
      </div>
            <div class="date-container2">
        <!-- 40 celdas CLAVE -->
        <input maxlength="40" type="date">
      </div>

      <div class="signature-box2">
        <canvas id="signature2"></canvas>
      </div>        
      <div class="signature-box2" onclick="abrirModal()">
        <img id="firma2" alt="Firma 2">
      </div>
    </form>
  </div>

  <!-- === MODAL === -->
  <div id="signatureModal">
    <div class="modal-content">
      <p><b>Firme en el recuadro:</b></p>
      <canvas id="signaturePad"></canvas><br>
      <button id="clearBtn">Limpiar</button>
      <button id="saveBtn">Guardar</button>
      <button id="closeBtn">Cerrar</button>
    </div>
  </div>

  <script>
    const modal = document.getElementById('signatureModal');
    const signaturePad = document.getElementById('signaturePad');
    const ctx = signaturePad.getContext('2d');
    const firma1 = document.getElementById('firma1');
    const firma2 = document.getElementById('firma2');
    let drawing = false;

    function resizeCanvas() {
      const rect = signaturePad.getBoundingClientRect();
      signaturePad.width = rect.width;
      signaturePad.height = rect.height;
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#000';
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function abrirModal() {
      modal.style.display = 'flex';
      resizeCanvas();
      ctx.clearRect(0, 0, signaturePad.width, signaturePad.height);
    }

    document.getElementById('closeBtn').onclick = () => modal.style.display = 'none';
    document.getElementById('clearBtn').onclick = () => ctx.clearRect(0, 0, signaturePad.width, signaturePad.height);

    document.getElementById('saveBtn').onclick = () => {
      const dataURL = signaturePad.toDataURL('image/png');
      firma1.src = dataURL;
      firma2.src = dataURL;
      modal.style.display = 'none';
    };

    function getPos(e) {
      const rect = signaturePad.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      return {
        x: clientX - rect.left,
        y: clientY - rect.top
      };
    }

    function startDraw(e) {
      drawing = true;
      const {x, y} = getPos(e);
      ctx.beginPath();
      ctx.moveTo(x, y);
      e.preventDefault();
    }

    function draw(e) {
      if (!drawing) return;
      const {x, y} = getPos(e);
      ctx.lineTo(x, y);
      ctx.stroke();
      e.preventDefault();
    }

    function endDraw() {
      drawing = false;
      ctx.beginPath();
    }

    signaturePad.addEventListener('mousedown', startDraw);
    signaturePad.addEventListener('mousemove', draw);
    signaturePad.addEventListener('mouseup', endDraw);
    signaturePad.addEventListener('mouseout', endDraw);

    signaturePad.addEventListener('touchstart', startDraw, { passive: false });
    signaturePad.addEventListener('touchmove', draw, { passive: false });
    signaturePad.addEventListener('touchend', endDraw);
  </script>
</body>
</html>
